<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>Pipeline Transcriptomic analysis using Salmon&sol;HISAT2--DESeq2&sol;EdgeR&lowbar;limmavoom</title>
        <style>
</style>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        
        <script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
        
    </head>
    <body class="vscode-body vscode-light">
        <h1 id="pipeline-transcriptomic-analysis-using-salmonhisat2--deseq2edger_limmavoom">Pipeline Transcriptomic analysis using Salmon/HISAT2--DESeq2/EdgeR_limmavoom</h1>
<p>By: Esteban Velásquez Agudelo</p>
<p>This document is a guide designed specifically for linux architectures to make a differential transcriptomics analysis with the most recomended programs to date according to some literature in 2020 [<a href="#7.-referencias">1</a>]. These softwares and packages have had recent updates and changes, like DESeq2 with lfcshrink [<a href="#7.-referencias">2</a>]. It is advised to read the last reviews with the latest updates in posterior dates. This guide is done using ubuntu 18.04 and with 6 samples:  2 Naturally resistant, 2 Artificially resistant and 2 susceptible strands. Apart from this guide one could use cufflinks, but not with tophat because is deprecated, and an useful guide to use it can be found here<a href="#6.-footnotes">^9</a>.</p>
<h1 id="methodology">Methodology</h1>
<p>A transcriptomic analysis in general is done in 5 steps, illustrated in Figure 1. in general these steps are:</p>
<ol>
<li>Quality analysis of the data and posterior trimming.</li>
<li>Data alignment to a reference genome or transcriptome <a href="#6.-footnotes">^1</a>.</li>
<li>Diferential trancription analysis from gene count or transcript quantification.</li>
<li>Ontological and pathway analysis of these differential transripted genes</li>
</ol>
<p align="center">
  <img width="460" height="300" src=TRANSCRIPTOMICANALYSIS.svg>
  <p align="center"> Figure 1. Methodology of a transcriptome analysis <p>
</p>
<h1 id="index">Index</h1>
<p align="center">
<!-- TOC depthFrom:1 depthTo:6 updateOnSave:false-->
<p><a href="#begginers">Begginers</a><br> <a href="#1-quality-data-analysis-and-filtering">1. Quality data analysis and filtering</a><br></p>
<ul>
<li><a href="#11-quality-analysis">1.1 Quality analysis</a><br></li>
<li><a href="#12-filtering-and-adaptor-trimming-using-trimmomatic">1.2 Filtering and adapter trimming using trimmomatic</a><br></li>
</ul>
<p><a href="#2filtered-read-alignment">2. Filtered read alignment</a><br></p>
<ul>
<li><a href="#21-read-alignment-using-hisat2">2.1 Read alignment using HISAT2</a><br></li>
<li><a href="#22-salmon-alignment">2.2 Salmon alignment</a></li>
</ul>
<p><a href="#3-diferrential-transcriptional-analysis">3. Diferrential transcriptional analysis</a></p>
<ul>
<li><a href="#31-installing-and-preparing-r-studio">3.1 Installing and preparing r studio</a></li>
<li><a href="#32-deseq2-analysis-from-hisat2-using-featurecounts">3.2 DESeq2 analysis from hisat2 using featurecounts</a></li>
<li><a href="#33-deseq2-analysis-from-salmon">3.3 DESeq2 analysis from salmon</a></li>
<li><a href="#34-analysis-using-limma-from-featurecounts">3.4 Analysis using limma from featurecounts</a></li>
<li><a href="#35-analysis-using-limma-from-salmon">3.5 Analysis using limma from salmon</a></li>
</ul>
<p><a href="#4-posterior-analysis">4. Posterior analysis</a></p>
<ul>
<li>
<p><a href="#41-obtaining-the-archive-of-go-terms-and-the-fatsa-files-of-the-diferentially-transcripted-genesdte">4.1 Obtaining the archive of GO terms and the fasta files of the differentailly transcripted genes(DTE)</a></p>
</li>
<li>
<p><a href="#42-r-graphs-of-the-go-terms">4.2 R graphs of the GO terms</a></p>
</li>
<li>
<p><a href="#43-set-analysis-of-dtg-using-the-fisher-test">4.3 Set analysis of DTG using the fisher test </a></p>
</li>
<li>
<p><a href="#44-pathway-analysis-using-keeg-kaas">4.4 Pathway analysis using KEEG-KAAS</a>)</p>
</li>
</ul>
<p><a href="#5-optionals">5. Optionals</a></p>
<ul>
<li>
<p><a href="#51-counting-with-ht-seq">5.1 Counting with HT-Seq</a></p>
</li>
<li>
<p><a href="#52-generating-a-gtf-from-a-gff">5.2 Generating a gtf from a gff</a></p>
</li>
<li>
<p><a href="#53-changing-the-formats-of-some-reads-with-biopython">5.3 Changing the formats of some reads with biopython</a></p>
</li>
<li>
<p><a href="#54-to-change-permisiion-in-files">5.4 Changing file permisions</a></p>
</li>
<li>
<p><a href="#55-transcriptome-de-novo-reconstruction">5.5 Transcriptome de novo reconstruction</a></p>
</li>
</ul>
<p><a href="#6.-footnotes">6. Footnotes</a>.</p>
<!-- /TOC -->
</p>
<h1 id="begginers">Begginers</h1>
<p>The first thing is to learn how to create environments inside of linux to be more efficient in computer CPU usage and in RAM usage. Environment creation is done with Conda, which is a package manager, but it also can be done without it. Conda is used here beacuse its easier to understand and use.</p>
<ul>
<li>To install conda use:</li>
</ul>
<pre><code class="language-bash"><div>bash Anaconda-latest-Linux-x86_64.sh
</div></code></pre>
<ul>
<li>with this command environments are created:</li>
</ul>
<pre><code class="language-bash"><div>conda create -n environment_name -c channel %program_to_download
</div></code></pre>
<ul>
<li>With these two comands the environment activates and deactivates</li>
</ul>
<pre><code class="language-bash"><div>conda activate environmente_name 
conda deactivate
</div></code></pre>
<p>Apart from this, it is necesary to know how to move inside a linux terminal with basic commands that move through folders, copying them and erasing them.</p>
<h1 id="1-quality-data-analysis-and-filtering">1. Quality data analysis and filtering</h1>
<h2 id="11-quality-analysis">1.1 Quality analysis:</h2>
<p>It is recomended to use FASTQC to all of the data you are going to analyse; and see the graph inside the html output of FASTQ to see which actions must be done. Some of the things one must verify are the percentage of bases in each position of the read, adapters content, quality in each position and the length of the reads.</p>
<p>In order to create an environment and run FASTQC for one sample you should use these commands, in which P102.fastq are the reads that are going to be analysed :</p>
<pre><code class="language-bash"><div>conda create -n fastqc fastqc
conda activate fastqc
fastqc -o P102 -t 4 P102.fastq
</div></code></pre>
<p align="center">
  <img width="460" height="300" src=fastqc.png>
  <p align="center"> Figure 2. Quality of each position in the FASTQC output<p>
</p>
<p>In the case of the example, one can see that at the end of the reads the quality goes very low, so it can be filtered, but we also have to take into account  waht we want when we align the reads, and explore the parameters in order to maximize that quality. in this specific case we see that the first 15 reads are equal for all the reads, so that is an adapter to be removed. we are also going to maximize unique read alignment by changing parameters in trimmomatic.</p>
<h2 id="12-filtering-and-adaptor-trimming-using-trimmomatic">1.2 filtering and adaptor trimming using trimmomatic</h2>
<p>One should download the binary version and uncompress it to the folder in which the data is, it can be downloaded here :<a href="http://www.usadellab.org/cms/?page=trimmomatic">http://www.usadellab.org/cms/?page=trimmomatic</a></p>
<p>The commands to filter the data and get the adapter trimmed; in which the first one is for Single reads and the second is for Paired reads are (the option to get the adapters trimmed is  HEADCROP and the best option to vary for data filtering in this dataset is the last number in SLIDINGWINDOW) :</p>
<pre><code class="language-bash"><div>java -jar trimmomatic-0.39.jar SE -phred33 -threads 8 P101T.fastq P101Trim.fastq LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36 HEADCROP:15

java -jar trimmomatic-0.39.jar PE -phred33 -threads 8 P101_F.fastq P101_R.fastq%(acá es necesario poner primero el forward y despues el reverse)% P101_forward_Paired P101_forward_Unpairedtrim.fq P101_reverse_Pairedtrim.fq  P101_forward_Unpairedtrim.fq LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINlEN:36 HEADCROP:15
</div></code></pre>
<h1 id="2filtered-read-alignment">2.Filtered read alignment</h1>
<h2 id="21-read-alignment-using-hisat2">2.1 Read alignment using HISAT2</h2>
<p>HISAT2 is the best genome aligner with STAR, although it uses a lot  of memmory and time. To use it one must first create an environment with HISAT2 installed, then one must create an index to align to and then do the alignment with the first commmand for single reads and the second one for paired reads.</p>
<pre><code class="language-bash"><div>conda create -n hisat hisat2

hisat2-build TriTrypDB-46_TcruziSylvioX10-1_Genome.fasta Tcruzi

hisat2 -q -p 8 -x Tcruzi -U P101T.fastq -S P101T.sam

hisat2 -q -p 8 -x Tcruzi -1 P101T_F.fastq -2 P101T_R -U P101T_Unpaired.fastq -S P101TP.sam

</div></code></pre>
<h3 id="211-changing-the-format-from-sam-to-bam">2.1.1 Changing the format from sam to bam</h3>
<p>To do this we should use the package samtools and the commands are the following:</p>
<pre><code class="language-bash"><div>conda create -n samtools samtools

samtools sort -@ 8 -o P101T12.bam P101Trim12.sam
 
samtools index ./P101/P101T12.bam

</div></code></pre>
<p><strong>Output</strong> of HISAT2:</p>
<pre><code><code><div>134810 reads; of these:&lt;p&gt;
  134810 (100.00%) were unpaired; of these:&lt;p&gt;
    58794 (43.61%) aligned 0 times&lt;p&gt;
    44963 (33.35%) aligned exactly 1 time&lt;p&gt;
    31053 (23.03%) aligned &gt;1 times&lt;p&gt;
56.39% overall alignment rate&lt;p&gt;
</div></code></code></pre>
<p>The most important quantity is the aligned exactly one time at least for the <em>T. cruzi </em>, in which the genome is pretty repetitive. One must change the SLIDINGWINDOW to maximize the mayority of alignments of exactly 1 time in the reads in this dataset.</p>
<h2 id="22-salmon-alignment">2.2 Salmon Alignment</h2>
<p>Salmon is the most preferable tool to do alignment and quantification due to the short time of usage and the alignment being done in respect to the transcriptome[<a href="#7.-referencias">3</a>]. It has 2 probable downsides which are the bad analysis for the small RNA and the lowly expressed RNA[<a href="#7.-referencias">4</a>]. To use the last version of Salmon, which in this case is the best, one must download the binary and uncompress it in the folder containing the filtrered reads here: <a href="https://github.com/COMBINE-lab/salmon/releases/tag/v1.3.0">https://github.com/COMBINE-lab/salmon/releases/tag/v1.3.0</a> and follow the next steps:</p>
<ul>
<li>uncompress the folder:</li>
</ul>
<pre><code class="language-bash"><div>tar xzvf salmon-1.2.0_linux_x86_64.tar.gz
</div></code></pre>
<ul>
<li>Creating a decoy with the transcriptome and the genome: (<a href="https://combine-lab.github.io/alevin-tutorial/2019/selective-alignment/">https://combine-lab.github.io/alevin-tutorial/2019/selective-alignment/</a>)<a href="#6.-footnotes">^2</a></li>
</ul>
<pre><code class="language-bash"><div>grep <span class="hljs-string">&quot;^&gt;&quot;</span> &lt;TriTrypDB-46_TcruziSylvioX10-1_Genome.fasta | cut -d <span class="hljs-string">&quot; &quot;</span> -f 1 &gt; decoys.txt
sed -i.bak -e <span class="hljs-string">&#x27;s/&gt;//g&#x27;</span> decoys.txt
cat TriTrypDB-48_TcruziSylvioX10-1_AnnotatedTranscripts.fasta TriTrypDB-46_TcruziSylvioX10-1_Genome.fasta &gt; gentrome.fasta

</div></code></pre>
<ul>
<li>Creating an index</li>
</ul>
<pre><code class="language-bash"><div>./salmon-late_linux_x86_64/bin/salmon index -t gentrome.fasta -d decoys.txt -p 8 -i salmon_index --gencode
</div></code></pre>
<ul>
<li>Read quantification for single reads and paired read respectively, in this case theA is used for automatic library identification :</li>
</ul>
<pre><code class="language-bash"><div>./salmon-latest_linux_x86_64/bin/salmon quant -i salmon_index -l A -r ./P101/fastqs/P101T12.fastq --validateMappings -o transcripts_quantP101

./salmon-latest_linux_x86_64/bin/salmon quant -i transcripts_index -l A -1 P101_1.fq -2 P101_2.fq --validateMappings -o transcripts_quantP101

</div></code></pre>
<p>After these steps one goes directly to R to make the analysis with DESSeq2 and/or EdgeR limma-voom.</p>
<h1 id="3-diferrential-transcriptional-analysis">3. Diferrential transcriptional analysis</h1>
<h2 id="31-installing-and-preparing-r-studio">3.1 Installing and preparing R studio</h2>
<p>All the steps followed here are done in R  4.0 in R studio, and to install it one must follow these commands in the linux terminal:</p>
<pre><code class="language-bash"><div>sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9

sudo add-apt-repository <span class="hljs-string">&#x27;deb https://cloud.r-project.org/bin/linux/ubuntu bionic-cran40/&#x27;</span>

sudo apt update

sudo apt install r-base
</div></code></pre>
<ul>
<li>Now to install r studio one has to download  the r studio version of the distribution one is using, which for this example is ubuntu 18.04; it can be downloaded here :<a href="https://rstudio.com/products/rstudio/download/#download">https://rstudio.com/products/rstudio/download/#download</a></li>
</ul>
<pre><code class="language-bash"><div>sudo apt install gdebi-core

sudo gdebi  rstudio-1.3.1093-amd64.deb
</div></code></pre>
<p>The last step is to install some dependencies in the linux terminal that r needs for certain packages that one will use:</p>
<pre><code class="language-bash"><div>sudo apt-get install libcurl4-gnutls-dev
sudo apt-get install libxml2-dev
sudo apt-get install libssl-dev
</div></code></pre>
<p>It is recommended to open rstudio from terminal with sudo permisions, and to install packages inside of r one must write in the r terminal:</p>
<pre><code class="language-r"><div><span class="hljs-keyword">if</span> (!requireNamespace(<span class="hljs-string">&quot;BiocManager&quot;</span>, quietly = <span class="hljs-literal">TRUE</span>))
    install.packages(<span class="hljs-string">&quot;BiocManager&quot;</span>)

BiocManager::install(<span class="hljs-string">&quot;Rsubread&quot;</span>)
</div></code></pre>
<h2 id="32-deseq2-analysis-from-hisat2-using-featurecounts">3.2 DESeq2 analysis from HISAT2 using featurecounts</h2>
<p>In R the first thing that has to be done is to count the mapped reads to the genome, which can be done eassily with featurecounts (this can also be done with HT-Seq, but its much slower, a guide of this is presented in optional steps). To install it one must install the package Rsubread with the comand mentioned earlier.</p>
<h3 id="321-counting-mapped-reads">3.2.1 counting mapped reads</h3>
<p>The following command is the one to count mapped reads, and we must be careful with the featureType option, which is the name of the gene that we are going to save. it can be inspected in the gtf and it must be in the following format TcYSYL_0000001. The last command is to verify that we did it nicely:</p>
<pre><code class="language-r"><div><span class="hljs-keyword">library</span>(Rsubread)

fc &lt;- featureCounts(files=c(<span class="hljs-string">&quot;./P101/P101T12.bam&quot;</span>, <span class="hljs-string">&quot;./P102/P102T12.bam&quot;</span>, <span class="hljs-string">&quot;./RCl3/RCl3T12.bam&quot;</span>, <span class="hljs-string">&quot;./RCL4/RCl4T12.bam&quot;</span>,<span class="hljs-string">&quot;./RL11/RL11T12.bam&quot;</span>,<span class="hljs-string">&quot;./RL12/RL12T12.bam&quot;</span>),nthreads=<span class="hljs-number">6</span>,annot.ext=<span class="hljs-string">&quot;TriTrypDB-46_TcruziSylvioX10-1.gff&quot;</span>,isGTFAnnotationFile=<span class="hljs-literal">TRUE</span>,GTF.featureType=<span class="hljs-string">&quot;exon&quot;</span>,GTF.attrType=<span class="hljs-string">&quot;ID&quot;</span>)

head(fc$counts)
</div></code></pre>
<p><strong>Output</strong>:</p>
<pre><code><code><div>                      P101T12.bam P102T12.bam RCl3T12.bam RCl4T12.bam RL11T12.bam RL12T12.bam
exon_TcSYL_0117800-E1           1           0           7           1           3           3
exon_TcSYL_0014440-E1           0           0           0           0           1           0
exon_TcSYL_0077180-E1           1           0           3           0           1           2
exon_TcSYL_0058970-E1           0           1           0           0           0           1
exon_TcSYL_0058900-E1           0           0           0           0           1           0
exon_TcSYL_0045600-E1           0           0           0           0           1           0
</div></code></code></pre>
<h3 id="322-importing-featurecounts-to-deseq2">3.2.2 Importing featurecounts to DESeq2</h3>
<ul>
<li>This specific guide is based on another guide, which is the best one according to the DESEq2 creator <a href="#6.-footnotes">^8</a>.</li>
</ul>
<h4 id="3221-creating-a-vector-that-summarizes-the-experimental-design">3.2.2.1 Creating a vector that summarizes the experimental design:</h4>
<p>One should verify that the order of the condition is the same as the fc  with the last command, and the commands to use are<a href="#6.-footnotes">^3</a>:</p>
<pre><code class="language-r"><div>condition&lt;-c(rep(<span class="hljs-string">&quot;Artificial&quot;</span>,<span class="hljs-number">4</span>),<span class="hljs-string">&quot;Natural&quot;</span>,<span class="hljs-string">&quot;Natural&quot;</span>)
coldata &lt;- matrix(c(rep(<span class="hljs-string">&quot;Artificial&quot;</span>,<span class="hljs-number">4</span>),<span class="hljs-string">&quot;Natural&quot;</span>,<span class="hljs-string">&quot;Natural&quot;</span>), dimnames = list(colnames(fc$counts), <span class="hljs-string">&#x27;condition&#x27;</span>))


coldata
</div></code></pre>
<p><strong>Output</strong>:</p>
<pre><code><code><div>            condition   
P101T12.bam &quot;Artificial&quot;
P102T12.bam &quot;Artificial&quot;
RCl3T12.bam &quot;Artificial&quot;
RCl4T12.bam &quot;Artificial&quot;
RL11T12.bam &quot;Natural&quot;   
RL12T12.bam &quot;Natural&quot;   
</div></code></code></pre>
<h4 id="3222--to-import-the-data-one-must-use-the-following-command">3.2.2.2  To import the data one must use the following command:</h4>
<p>To save the information of the genes the command of the second paragraph is used and the last command is used to verify that everything went smooth:</p>
<pre><code class="language-r"><div><span class="hljs-keyword">library</span>(<span class="hljs-string">&quot;DESeq2&quot;</span>)

dds &lt;- DESeqDataSetFromMatrix(countData=fc$counts, colData=coldata(fc$counts), design=~condition)


featureData &lt;- data.frame(gene=rownames(fc))
mcols(dds) &lt;- DataFrame(mcols(dds), featureData)
mcols(dds)

colData(dds)
</div></code></pre>
<p><strong>Output</strong>:</p>
<pre><code class="language-r"><div>             condition
              &lt;factor&gt;
P101T12.bam Artificial
P102T12.bam Artificial
RCl3T12.bam Artificial
RCl4T12.bam Artificial
RL11T12.bam Natural   
RL12T12.bam Natural  
</div></code></pre>
<h3 id="323-generating-the-differential-analysis">3.2.3 Generating the differential analysis</h3>
<p>the steps to be followed are:</p>
<h4 id="3231-agregate-the-factors-well">3.2.3.1. Agregate the factors well</h4>
<pre><code class="language-r"><div>colData(dds)$condition &lt;- factor(colData(dds)$condition, levels=c(<span class="hljs-string">&quot;Artificial&quot;</span>,<span class="hljs-string">&quot;Natural&quot;</span>))

dds$condition &lt;- relevel(dds$condition, ref = <span class="hljs-string">&quot;Artificial&quot;</span>)
</div></code></pre>
<h4 id="3232-previsualizing-the-data">3.2.3.2. Previsualizing the data</h4>
<p>The colors are the number of experiments</p>
<pre><code class="language-r"><div>boxplot(log10(counts(dds)+<span class="hljs-number">1</span>),col=c(<span class="hljs-string">&quot;red&quot;</span>,<span class="hljs-string">&quot;green&quot;</span>,<span class="hljs-string">&quot;blue&quot;</span>,<span class="hljs-string">&quot;yellow&quot;</span>,<span class="hljs-string">&#x27;brown&#x27;</span>,<span class="hljs-string">&#x27;gray&#x27;</span>),las=<span class="hljs-number">2</span>)
title(main=<span class="hljs-string">&quot;Unnormalized data and library size DEseq2&quot;</span>, ylab=<span class="hljs-string">&quot;Log-counts&quot;</span>) 
</div></code></pre>
<p align="center">
  <img width="460" height="300" src=unnormDESeq2.png>
  <p align="center"> Figure 3. Data previsualization using DESeq2<p>
</p>
<h4 id="3233-transforming-the-data-to-pca-visualization">3.2.3.3. Transforming the data to PCA visualization:</h4>
<p>When to many differences are expected the option of blind must be false.</p>
<pre><code class="language-r"><div>rld &lt;- rlogTransformation(dds, blind = <span class="hljs-literal">TRUE</span>)
plotPCA(rld, intgroup = c(<span class="hljs-string">&quot;condition&quot;</span>))
</div></code></pre>
<p align="center">
  <img width="460" height="300" src=PCADESeq2.png>
  <p align="center"> Figura 4. PCA DESeq2 <p>
</p>
<h4 id="3234-biological-variance-estimation">3.2.3.4. Biological variance estimation</h4>
<p>This is done to see the options of the different fitTypes used, be it local or parametric, this ca be done with fitType='local' with a comma in estimateDispersion <a href="#6.-footnotes">^7</a>.</p>
<pre><code class="language-r"><div>dds &lt;- estimateSizeFactors(dds)
dds &lt;- estimateDispersions(dds)
plotDispEsts(dds)
</div></code></pre>
<p align="center">
  <img width="460" height="300" src=dispDESeq2.png>
  <p align="center"> Figure 5. Dispersion DESeq2 <p>
</p>
<h4 id="3235-determinend-the-diferential-transcription">3.2.3.5. Determinend the diferential transcription,</h4>
<ul>
<li>One can change the fitType but one must be carefull, the default and generally the best one is parametric , but it's better to analyze it with the dispersion plot and this can be changed with fitType='local'. One can ask like this guy in the bioconductor supportto see which option is the best :<a href="https://support.bioconductor.org/p/81094/">https://support.bioconductor.org/p/81094/</a></li>
</ul>
<pre><code class="language-r"><div>dds&lt;-estimateSizeFactors(dds)
dds &lt;- estimateDispersions(dds,fitType=<span class="hljs-string">&#x27;local&#x27;</span>)
dds &lt;-nbinomWaldTest(dds)
res &lt;- results(dds, contrast = c(<span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;Natural&#x27;</span>, <span class="hljs-string">&#x27;Artificial&#x27;</span>),alpha=<span class="hljs-number">0.05</span>)
summary(res)
</div></code></pre>
<p><strong>Output</strong>:</p>
<pre><code><code><div>out of 16240 with nonzero total read count
adjusted p-value &lt; 0.05
LFC &gt; 0 (up)       : 1, 0.0062%
LFC &lt; 0 (down)     : 39, 0.24%
outliers [1]       : 2, 0.012%
low counts [2]     : 13657, 84%
(mean count &lt; 4)
[1] see 'cooksCutoff' argument of ?results
[2] see 'independentFiltering' argument of ?results
</div></code></code></pre>
<h4 id="3236-removing-the-size-effect-with-the-last-updated-package">3.2.3.6. Removing the size effect with the last updated package:</h4>
<p>One can change the hypothesis used here by changing the lfc threshold<a href="#6.-footnotes">^4</a></p>
<pre><code class="language-r"><div>coefi&lt;-resultsNames(dds)
lfcutoff&lt;-<span class="hljs-number">0.5</span>
res.lfc2 &lt;- lfcShrink(dds, coef=coefi[<span class="hljs-number">2</span>], type=<span class="hljs-string">&quot;apeglm&quot;</span>,res=res) 
res&lt;-res.lfc2
summary(res.lfc2)
</div></code></pre>
<p><strong>Output</strong>:</p>
<pre><code><code><div>out of 16240 with nonzero total read count
adjusted p-value &lt; 0.05
LFC &gt; 0 (up)       : 1, 0.0062%
LFC &lt; 0 (down)     : 39, 0.24%
outliers [1]       : 2, 0.012%
low counts [2]     : 13657, 84%
(mean count &lt; 4)
[1] see 'cooksCutoff' argument of ?results
[2] see 'independentFiltering' argument of ?results
</div></code></code></pre>
<h4 id="3237-visualizing-the-results-with-an-maplot">3.2.3.7. Visualizing the results with an MAplot:</h4>
<p>For publication one can use a single graph</p>
<pre><code class="language-r"><div>par(mfrow=c(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>))
lims &lt;- c(-<span class="hljs-number">8</span>,<span class="hljs-number">8</span>)
xlab &lt;- <span class="hljs-string">&quot;mean of normalized counts&quot;</span>
plotMA(res.lfc2, ylim=c(-<span class="hljs-number">2</span>,<span class="hljs-number">2</span>), main=<span class="hljs-string">&quot;apeglm, LFC NaturalvsArtificial&quot;</span>, alpha=<span class="hljs-number">0.05</span>)
hline()
plotMA(dds,ylim=c(-<span class="hljs-number">2</span>,<span class="hljs-number">2</span>),main=<span class="hljs-string">&quot;DESeq2&quot;</span>)
hline()
</div></code></pre>
<p align="center">
  <img width="460" height="300" src=MADESeq2.png>
  <p align="center"> Figure 6. MA plot <p>
</p>
<h4 id="3238-making-an-interactive-graph-for-better-analysis">3.2.3.8. Making an interactive graph for better analysis:</h4>
<pre><code class="language-r"><div><span class="hljs-keyword">library</span>(<span class="hljs-string">&quot;Glimma&quot;</span>)
status &lt;- as.numeric(res$padj &lt; <span class="hljs-number">.1</span>)
anno &lt;- data.frame(GeneID=rownames(res), symbol=res$padj)
glMDPlot(res, status=status, counts=counts(dds,normalized=<span class="hljs-literal">TRUE</span>), groups=dds$condition, transform=<span class="hljs-literal">FALSE</span>, samples=colnames(dds), anno, folder=<span class="hljs-string">&quot;glimma&quot;</span>, launch=<span class="hljs-literal">TRUE</span>)
</div></code></pre>
<h4 id="3239-creating-a-list-of-differentially-positive-and-negative-trancripted-genes">3.2.3.9. Creating a list of differentially positive and negative trancripted genes</h4>
<p>One obtains a list of positive an a list of negative making the nomenclature the same as TriTryp like TcYSyl_0000001.</p>
<pre><code class="language-r"><div>df&lt;-data.frame(res)
DOWN&lt;-which(df$padj&lt;<span class="hljs-number">0.05</span>  &amp; df$log2FoldChange&lt;<span class="hljs-number">0</span> )
UP&lt;-which(df$padj&lt;<span class="hljs-number">0.05</span>  &amp; df$log2FoldChange&gt;<span class="hljs-number">0</span> )
DEDOWN&lt;-rownames(df[DOWN,])
DEUP&lt;-rownames(df[UP,])


Nomgenes &lt;- <span class="hljs-keyword">function</span>(DEDOWN) {
  <span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:length(DEDOWN)){
    DEDOWN[i]&lt;-paste(<span class="hljs-string">&quot;TcSYL_&quot;</span>,sub(sprintf(<span class="hljs-string">&quot;.*%s(.*)%s.*&quot;</span>,<span class="hljs-string">&quot;_&quot;</span>, <span class="hljs-string">&quot;-&quot;</span>), <span class="hljs-string">&quot;\\1&quot;</span>, DEDOWN[i]))
  }
  <span class="hljs-keyword">return</span>(DEDOWN)
}
trimgenes &lt;- <span class="hljs-keyword">function</span>(DOWNshrink) {
  <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:length(DOWNshrink)){
    DOWNshrink[i]&lt;-gsub(<span class="hljs-string">&quot; &quot;</span> ,<span class="hljs-string">&quot;&quot;</span>,DOWNshrink[i])
  }
  <span class="hljs-keyword">return</span>(DOWNshrink)
}

DEDOWN&lt;-trimgenes(Nomgenes(DEDOWN))
DEUP&lt;-trimgenes(Nomgenes(DEUP))


write(paste(DEDOWN, collapse = <span class="hljs-string">&#x27;,&#x27;</span>), <span class="hljs-string">&#x27;DESeq2.DEGdownlocal.results.txt&#x27;</span>) 
write(paste(DEUP, collapse = <span class="hljs-string">&#x27;,&#x27;</span>), <span class="hljs-string">&#x27;DESeq2.DEGuplocal.results.txt&#x27;</span>)
</div></code></pre>
<h2 id="33-deseq2-analysis-from-salmon">3.3 DESeq2 analysis from Salmon</h2>
<h3 id="331-creating-a-matrix-of-gene-transcript">3.3.1 Creating a matrix of gene-transcript</h3>
<p>It's better to have the .gtf in the same folder as where the analysis is going to be done, the packages must be installed beforehand</p>
<pre><code class="language-r"><div><span class="hljs-keyword">library</span>(tximport)
<span class="hljs-keyword">library</span>(<span class="hljs-string">&quot;readr&quot;</span>)
<span class="hljs-keyword">library</span>(<span class="hljs-string">&quot;tximportData&quot;</span>)
<span class="hljs-keyword">library</span>(GenomicFeatures)
txdb &lt;- makeTxDbFromGFF(<span class="hljs-string">&quot;TriTrypDB-46_TcruziSylvioX10-1.gtf&quot;</span>)
k &lt;- keys(txdb, keytype = <span class="hljs-string">&quot;GENEID&quot;</span>)
tx2gene &lt;- select(txdb, keys = k, keytype = <span class="hljs-string">&quot;GENEID&quot;</span>, columns = <span class="hljs-string">&quot;TXNAME&quot;</span>)
</div></code></pre>
<h3 id="332-creating-a-matrix-of-the-experimental-design">3.3.2 Creating a matrix of the experimental design</h3>
<p>To create it one must write the next commands, it is also to neccesary to verify that the last output is true with the last command:</p>
<pre><code class="language-r"><div>vv &lt;- c(<span class="hljs-string">&quot;transcripts_quantP101&quot;</span>, <span class="hljs-string">&quot;transcripts_quantP102&quot;</span>, <span class="hljs-string">&quot;transcripts_quantRCl3&quot;</span>, <span class="hljs-string">&quot;transcripts_quantRCl4&quot;</span>,<span class="hljs-string">&quot;transcripts_quantRL11&quot;</span>,<span class="hljs-string">&quot;transcripts_quantRL12&quot;</span>,rep(<span class="hljs-string">&quot;Artificial&quot;</span>,<span class="hljs-number">4</span>),<span class="hljs-string">&quot;Natural&quot;</span>,<span class="hljs-string">&quot;Natural&quot;</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>)
samples &lt;- matrix(vv,nrow= <span class="hljs-number">6</span>, ncol = <span class="hljs-number">3</span>, byrow = <span class="hljs-literal">FALSE</span>)
colnames(samples) &lt;- c(<span class="hljs-string">&quot;sample&quot;</span>,<span class="hljs-string">&quot;Resistance&quot;</span>,<span class="hljs-string">&quot;Experiment&quot;</span>)
samples&lt;-data.frame(samples)
samples$condition &lt;- factor(c(rep(<span class="hljs-string">&quot;Artificial&quot;</span>,<span class="hljs-number">4</span>),rep(<span class="hljs-string">&#x27;Natural&#x27;</span>,<span class="hljs-number">2</span>)))
files &lt;- file.path(<span class="hljs-string">&quot;.&quot;</span>, samples$sample, <span class="hljs-string">&quot;quant.sf&quot;</span>)
names(files) &lt;- paste0(samples$sample)
all(file.exists(files)

</div></code></pre>
<h3 id="332-importing-the-salmon-files">3.3.2 Importing the salmon files</h3>
<pre><code class="language-r"><div>txi &lt;- tximport(files, type = <span class="hljs-string">&quot;salmon&quot;</span>, tx2gene = tx2gene, ignoreTxVersion = <span class="hljs-literal">TRUE</span>)
names(txi)
<span class="hljs-keyword">library</span>(DESeq2)
condition &lt;- factor(c(rep(<span class="hljs-string">&quot;Artificial&quot;</span>,<span class="hljs-number">4</span>),rep(<span class="hljs-string">&#x27;Natural&#x27;</span>,<span class="hljs-number">2</span>)))
dds &lt;- DESeqDataSetFromTximport(txi, samples, ~condition)
</div></code></pre>
<p>now we should do the steps from <a href="#3.2.3.1.-agregar-los-factores-bien">3.2.3.1</a></p>
<h2 id="34-analysis-using-limma-from-featurecounts">3.4 Analysis using limma from featurecounts</h2>
<h3 id="341-counting-using-featurecounts">3.4.1 Counting using featurecounts:</h3>
<pre><code class="language-r"><div><span class="hljs-keyword">library</span>(Rsubread)
fc &lt;- featureCounts(files=c(<span class="hljs-string">&quot;./P101/P101T12.bam&quot;</span>, <span class="hljs-string">&quot;./P102/P102T12.bam&quot;</span>, <span class="hljs-string">&quot;./RCl3/RCl3T12.bam&quot;</span>, <span class="hljs-string">&quot;./RCL4/RCl4T12.bam&quot;</span>,<span class="hljs-string">&quot;./RL11/RL11T12.bam&quot;</span>,<span class="hljs-string">&quot;./RL12/RL12T12.bam&quot;</span>),nthreads=<span class="hljs-number">8</span>,annot.ext=<span class="hljs-string">&quot;TriTrypDB-46_TcruziSylvioX10-1.gff&quot;</span>,isGTFAnnotationFile=<span class="hljs-literal">TRUE</span>,GTF.featureType=<span class="hljs-string">&quot;exon&quot;</span>,GTF.attrType=<span class="hljs-string">&quot;ID&quot;</span>)
head(fc$counts)
</div></code></pre>
<h3 id="342-creating-a-dgeobject-from-featurecounts">3.4.2 Creating a DGEobject from featurecounts</h3>
<pre><code class="language-r"><div><span class="hljs-keyword">library</span>(edgeR)
x &lt;- DGEList(counts=fc$counts, genes=fc$annotation[,c(<span class="hljs-string">&quot;GeneID&quot;</span>,<span class="hljs-string">&quot;Length&quot;</span>)])
</div></code></pre>
<h3 id="343-data-previsualization">3.4.3 Data previsualization</h3>
<pre><code class="language-r"><div>lcpm &lt;- cpm(x, log=<span class="hljs-literal">TRUE</span>)
boxplot(lcpm, las=<span class="hljs-number">2</span>,main=<span class="hljs-string">&quot;&quot;</span>,col=c(<span class="hljs-string">&quot;red&quot;</span>,<span class="hljs-string">&quot;green&quot;</span>,<span class="hljs-string">&quot;blue&quot;</span>,<span class="hljs-string">&quot;brown&quot;</span>,<span class="hljs-string">&quot;yellow&quot;</span>,<span class="hljs-string">&quot;gray&quot;</span>))
title(main=<span class="hljs-string">&quot;Unnormalized data and library size&quot;</span>, ylab=<span class="hljs-string">&quot;Log-cpm&quot;</span>)
</div></code></pre>
<p align="center">
  <img width="460" height="300" src=boxplotlimma.png>
  <p align="center"> Figure 7. Previsualization of data with Limma<p>
</p>
<h3 id="344-data-filtering">3.4.4 Data filtering</h3>
<pre><code class="language-r"><div>isexpr &lt;- rowSums(cpm(x) &gt; <span class="hljs-number">10</span>) &gt;= <span class="hljs-number">2</span>
x &lt;- x[isexpr,]
</div></code></pre>
<h3 id="345-normalizing-the-data-with--tmm">3.4.5 Normalizing the data with  TMM</h3>
<pre><code class="language-r"><div>x2 &lt;- calcNormFactors(x, method = <span class="hljs-string">&quot;TMM&quot;</span>)
lcpm2 &lt;- cpm(x2, log=<span class="hljs-literal">TRUE</span>)
boxplot(lcpm2, las=<span class="hljs-number">2</span>,main=<span class="hljs-string">&quot;&quot;</span>,col=c(<span class="hljs-string">&quot;red&quot;</span>,<span class="hljs-string">&quot;green&quot;</span>,<span class="hljs-string">&quot;blue&quot;</span>,<span class="hljs-string">&quot;brown&quot;</span>,<span class="hljs-string">&quot;yellow&quot;</span>,<span class="hljs-string">&quot;gray&quot;</span>))
title(main=<span class="hljs-string">&quot;Normalised data&quot;</span>, ylab=<span class="hljs-string">&quot;Log-cpm&quot;</span>)

</div></code></pre>
<p align="center">
  <img width="460" height="300" src=boxplotnormlimma.png>
  <p align="center"> Figure 8. Visualizing normalized data with limma<p>
</p>
<h3 id="346-creating-a-designed-matrix">3.4.6 Creating a designed matrix</h3>
<pre><code class="language-r"><div>vv &lt;- c(<span class="hljs-string">&quot;P101&quot;</span>, <span class="hljs-string">&quot;P102&quot;</span>, <span class="hljs-string">&quot;RCl3&quot;</span>, <span class="hljs-string">&quot;RCl4&quot;</span>,<span class="hljs-string">&quot;RL11&quot;</span>,<span class="hljs-string">&quot;RL12&quot;</span>,rep(<span class="hljs-string">&quot;Artificial&quot;</span>,<span class="hljs-number">4</span>),<span class="hljs-string">&quot;Natural&quot;</span>,<span class="hljs-string">&quot;Natural&quot;</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>)
targets &lt;- matrix(vv,nrow= <span class="hljs-number">6</span>, ncol = <span class="hljs-number">3</span>, byrow = <span class="hljs-literal">FALSE</span>)
colnames(targets) &lt;- c(<span class="hljs-string">&quot;Filename&quot;</span>,<span class="hljs-string">&quot;Resistance&quot;</span>,<span class="hljs-string">&quot;experiment&quot;</span>)
celltype &lt;- factor(targets[,<span class="hljs-number">2</span>])
design &lt;- model.matrix(~<span class="hljs-number">0</span>+celltype)
colnames(design) &lt;- levels(celltype)
</div></code></pre>
<h3 id="347-normalization-based-on-voom">3.4.7 Normalization based on voom</h3>
<pre><code class="language-r"><div>y1&lt;- voom(x2,design,plot=<span class="hljs-literal">TRUE</span>)
</div></code></pre>
<h3 id="348-clusterization-with-pca">3.4.8 Clusterization with PCA</h3>
<pre><code class="language-r"><div>opar &lt;- par(no.readonly = <span class="hljs-literal">TRUE</span>)
par(xpd = <span class="hljs-literal">TRUE</span>, mar = par()$mar + c(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>))
plotMDS(y1,xlim=c(-<span class="hljs-number">2.5</span>,<span class="hljs-number">3</span>),labels = c(<span class="hljs-string">&quot;P101&quot;</span>, <span class="hljs-string">&quot;P102&quot;</span>, <span class="hljs-string">&quot;RCl3&quot;</span>, <span class="hljs-string">&quot;RCl4&quot;</span>,<span class="hljs-string">&quot;RL11&quot;</span>,<span class="hljs-string">&quot;RL12&quot;</span>),col=c(rep(<span class="hljs-string">&quot;green&quot;</span>,<span class="hljs-number">4</span>),<span class="hljs-string">&quot;red&quot;</span>,<span class="hljs-string">&quot;red&quot;</span>))
legend(par(<span class="hljs-string">&quot;usr&quot;</span>)[<span class="hljs-number">2</span>], par(<span class="hljs-string">&quot;usr&quot;</span>)[<span class="hljs-number">4</span>], c(<span class="hljs-string">&quot;Artificial&quot;</span>,<span class="hljs-string">&quot;Natural&quot;</span>), pch = <span class="hljs-number">16</span>, col = c(<span class="hljs-string">&quot;green&quot;</span>,<span class="hljs-string">&quot;red&quot;</span>), bty = <span class="hljs-string">&quot;n&quot;</span>)
</div></code></pre>
<p align="center">
  <img width="460" height="300" src=PCAfilter.png>
  <p align="center"> Figure 9. PCA with Limma<p>
</p>
<h3 id="349-aplying-the-linear-model-for-the-differential-transcription">3.4.9 Aplying the linear model for the differential transcription:</h3>
<br>
In this case the option Trend and robust are used. Robust filters the genes taht have a variance very different fron the mean, and trend is used when the difference of mean of the size of each library is not greater than 3 fold. 
<pre><code class="language-r"><div>fit1 &lt;- lmFit(y1,design)
contr &lt;- makeContrasts(ArtificialvsNatural=Artificial-Natural,levels=design)
fit1.contr &lt;- eBayes(contrasts.fit(fit1,contr),trend = <span class="hljs-literal">TRUE</span>,robust = <span class="hljs-literal">TRUE</span>) 
dt1 &lt;- decideTests(fit1.contr)
summary(dt1)
</div></code></pre>
<h3 id="3410-comparing-the-models">3.4.10 Comparing the models:</h3>
<p>Now the dispersions are compared from each model iwth the command [<a href="#-349-Aplying-the-linear-model-for-the-differential-rasncription">3.4.9</a>] taking the robust and trend to false independently and then comparing the different SA plots to se which one is better to use:.</p>
<pre><code class="language-r"><div>plotSA(fit1.contr)
</div></code></pre>
<p align="center">
  <img width="460" height="300" src=SAplot.png>
  <p align="center"> Figure 10. Dispersion with Limma trend and robust<p>
</p>
<h3 id="3411-visualizing-the-data-with-a-ma-plot-and-an-interactive-maplot-using-limma">3.4.11 Visualizing the data with a MA plot and an interactive MAplot using limma</h3>
<p>The Ma is for publications and the glimma is used to analize carefully the data and later analysis.</p>
<pre><code class="language-r"><div>tfit1 &lt;- treat(fit1, lfc=<span class="hljs-number">1</span>)
plotMD(tfit1, column=<span class="hljs-number">1</span>, status=dt1[,<span class="hljs-number">1</span>], main=colnames(tfit1)[<span class="hljs-number">1</span>], xlim=c(<span class="hljs-number">0</span>,<span class="hljs-number">15</span>),ylim=c(<span class="hljs-number">0</span>,<span class="hljs-number">12</span>))
<span class="hljs-keyword">library</span>(Glimma)
glMDPlot(tfit1, coef=<span class="hljs-number">1</span>, status=dt, main=colnames(tfit1)[<span class="hljs-number">1</span>],side.main=<span class="hljs-string">&quot;ENTREZID&quot;</span>, counts=lcpm, groups=celltype, launch=<span class="hljs-literal">FALSE</span>)
</div></code></pre>
<p align="center">
  <img width="460" height="300" src=MAplotlimma.png>
  <p align="center"> Figure 11. MAPlot of limma with robust and trend<p>
</p>
<h3 id="3412-creating-output-files">3.4.12 Creating output files</h3>
<p>Saving the list of the diferentially transcripted genes for GO and pathways analysis. This aproximation is a little brute force so maybe you can upgrade it.</p>
<h4 id="34121-creating-a-table-of-diferentially-transcripted-genes">3.4.12.1 Creating a table of diferentially transcripted genes</h4>
<pre><code class="language-r"><div>voom.tt &lt;- topTable(fit1.contr, adjust.method = <span class="hljs-string">&quot;BH&quot;</span>,number= <span class="hljs-literal">Inf</span>)
voom.limma.results &lt;- data.frame(gene.id = rownames(voom.tt), p.value = voom.tt$P.Value, q.value = voom.tt$adj.P.Val, log.fc = voom.tt$logFC, test.stat = voom.tt$t, row.names = <span class="hljs-literal">NULL</span>)
</div></code></pre>
<h4 id="34122-selecting-the-genes-down-and-up-regulated">3.4.12.2 selecting the genes down and up regulated</h4>
<pre><code class="language-r"><div>De.limma.down&lt;- which(dt1[,<span class="hljs-number">1</span>]==-<span class="hljs-number">1</span>)
De.limma.up&lt;-which(dt1[,<span class="hljs-number">1</span>]==<span class="hljs-number">1</span>)
de.limma.down=c()
<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> De.limma.down){
  de.limma.down&lt;-c(de.limma.down, dimnames(dt1[i,<span class="hljs-number">0</span>])[[<span class="hljs-number">1</span>]])
}
de.limma.down
de.limma.up=c()
<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> De.limma.up){
  de.limma.up&lt;-c(de.limma.up, dimnames(dt1[i,<span class="hljs-number">0</span>])[[<span class="hljs-number">1</span>]])
}
de.limma.up
position&lt;-voom.limma.results$q.value&lt;<span class="hljs-number">0.05</span>
DEgenesdown&lt;-c()
</div></code></pre>
<h4 id="34123-changing-the-format-to-tritryp">3.4.12.3 changing the format to TriTryp</h4>
<p>The names of the genes are searched in the tritryp format specified above, without spaces</p>
<pre><code class="language-r"><div><span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:length(position)){
  <span class="hljs-keyword">if</span>(position[i]==<span class="hljs-literal">TRUE</span> &amp; voom.limma.results$gene.id[i] %<span class="hljs-keyword">in</span>% de.limma.down){
    DEgenesdown &lt;- c(DEgenesdown, trimws(paste(<span class="hljs-string">&quot;TcSYL_&quot;</span>,sub(sprintf(<span class="hljs-string">&quot;.*%s(.*)%s.*&quot;</span>,<span class="hljs-string">&quot;_&quot;</span>, <span class="hljs-string">&quot;-&quot;</span>), <span class="hljs-string">&quot;\\1&quot;</span>, voom.limma.results$gene.id[i]))))
  }
}
DEgenedown=c()
<span class="hljs-keyword">for</span> (x <span class="hljs-keyword">in</span> DEgenesdown){
  DEgenedown&lt;-c(DEgenedown, gsub(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot;&quot;</span>, x, fixed = <span class="hljs-literal">TRUE</span>))
}
DEgenesup&lt;-c()
<span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:length(position)){
  <span class="hljs-keyword">if</span>(position[i]==<span class="hljs-literal">TRUE</span> &amp; voom.limma.results$gene.id[i] %<span class="hljs-keyword">in</span>% de.limma.up){
    DEgenesup &lt;- c(DEgenesup, trimws(paste(<span class="hljs-string">&quot;TcSYL_&quot;</span>,sub(sprintf(<span class="hljs-string">&quot;.*%s(.*)%s.*&quot;</span>,<span class="hljs-string">&quot;_&quot;</span>, <span class="hljs-string">&quot;-&quot;</span>), <span class="hljs-string">&quot;\\1&quot;</span>, voom.limma.results$gene.id[i]))))
  }
}
DEgeneup=c()
<span class="hljs-keyword">for</span> (x <span class="hljs-keyword">in</span> DEgenesup){
  DEgeneup&lt;-c(DEgeneup, gsub(<span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot;&quot;</span>, x, fixed = <span class="hljs-literal">TRUE</span>))
}
</div></code></pre>
<h4 id="34124-veryfication-and-writing">3.4.12.4 veryfication and writing</h4>
<p>The data are visually inspected and then saved</p>
<pre><code class="language-r"><div>DEgeneup
DEgenedown 
write(paste(DEgenedown, collapse = <span class="hljs-string">&#x27;,&#x27;</span>), <span class="hljs-string">&#x27;limma.DEGdown.results.txt&#x27;</span>)
write(paste(DEgeneup, collapse = <span class="hljs-string">&#x27;,&#x27;</span>), <span class="hljs-string">&#x27;limma.DEGup.results.txt&#x27;</span>)
</div></code></pre>
<h2 id="35-analysis-using-limma-from-salmon">3.5 Analysis using limma from salmon</h2>
<p>A matix of pairs gene-transcripts is created the same way as in the DESeq2 in <a href="#331-Creating-a-matrix-of-gene-transcript">3.3.1</a></p>
<h3 id="352-importing-the-data-to-create-a-dge-object">3.5.2 Importing the data to create a DGE object:</h3>
<pre><code class="language-r"><div>txi &lt;- tximport(files, type = <span class="hljs-string">&quot;salmon&quot;</span>, tx2gene = tx2gene, ignoreTxVersion = <span class="hljs-literal">TRUE</span>, countsFromAbundance = <span class="hljs-string">&quot;lengthScaledTPM&quot;</span>)
<span class="hljs-keyword">library</span>(limma)
<span class="hljs-keyword">library</span>(edgeR)
y &lt;- DGEList(txi$counts)
</div></code></pre>
<h3 id="353-filtering-the-data-ad-creating-a-condition-then-normalizing">3.5.3 Filtering the data ad creating a condition then normalizing</h3>
<pre><code class="language-r"><div>isexpr &lt;- rowSums(cpm(y) &gt; <span class="hljs-number">5</span>) &gt;= <span class="hljs-number">4</span>
y &lt;- y[isexpr,]
condition &lt;- factor(c(rep(<span class="hljs-string">&quot;Artificial&quot;</span>,<span class="hljs-number">4</span>),rep(<span class="hljs-string">&#x27;Natural&#x27;</span>,<span class="hljs-number">2</span>)))
y &lt;- calcNormFactors(y,method = <span class="hljs-string">&quot;TMM&quot;</span>)
lcpm2 &lt;- cpm(y, log=<span class="hljs-literal">TRUE</span>)
boxplot(lcpm2, las=<span class="hljs-number">2</span>,main=<span class="hljs-string">&quot;&quot;</span>,col=c(<span class="hljs-string">&quot;red&quot;</span>,<span class="hljs-string">&quot;green&quot;</span>,<span class="hljs-string">&quot;blue&quot;</span>,<span class="hljs-string">&quot;brown&quot;</span>,<span class="hljs-string">&quot;yellow&quot;</span>,<span class="hljs-string">&quot;gray&quot;</span>))
title(main=<span class="hljs-string">&quot;Normalised data&quot;</span>, ylab=<span class="hljs-string">&quot;Log-cpm&quot;</span>)
y &lt;- voom(y, design)

</div></code></pre>
<p align="center">
  <img width="460" height="300" src=normalizedcounts.png>
  <p align="center"> Figure 12. Boxplot of normalized using salmon and limma<p>
</p>
<p>The next steps are the same as in the <a href="#348-Clusterization-with-PCA">3.4.8</a> with a little difference at the end (<a href="#3.4.12-crear-archivos-de-salida">3.4.12</a>) because the names are from transcripts and not genes:</p>
<pre><code class="language-r"><div>DEgenesdown &lt;- c(DEgenesdown,substr(voom.limma.results$gene.id[i],<span class="hljs-number">1</span>,nchar(voom.limma.results$gene.id[i])-<span class="hljs-number">3</span>))
</div></code></pre>
<h1 id="4-posterior-analysis">4. Posterior analysis</h1>
<h2 id="41--obtaining-the-archive-of-go-terms-and-the-fatsa-files-of-the-diferentially-transcripted-genesdte">4.1  Obtaining the archive of GO terms and the fatsa files of the Diferentially transcripted genes(DTE).</h2>
<p>First one must enter to the site :<a href="https://tritrypdb.org/tritrypdb/app/">https://tritrypdb.org/tritrypdb/app/</a> then click in the box  <strong>Search for</strong>  after that click in the <strong>Genes</strong>, afterwards <strong>Annotation, curaton and identifiers</strong> and lastly <strong>Gene ID</strong> . In this window one should select <strong>upload a text file</strong>  now you name your search and click in <strong>Get Answer</strong>. Susequently one must click in Download<a href="#6.-footnotes">^5</a>. <br>
After that one selects depending of the analysis:</p>
<h3 id="411-go-analysis">4.1.1 Go analysis:</h3>
<p>One must select : <strong>Tab- or comma-delimited (openable in Excel) - choose a pre-configured table</strong>. then check  <strong>function prediction y GO Terms</strong>. following that one slecets <strong>Comma-delimited (.csv) file</strong> and finally  <strong>Get</strong>.</p>
<h3 id="412-pathway-analysis">4.1.2 Pathway analysis:</h3>
<p>One must create a fasta file of the up and down regulated genes independently in the following way: check in <strong>FASTA - sequence retrieval, configurable</strong>. Then slect <strong>Protein</strong>, after that <strong>Text File</strong> and lastly <strong>Get Sequences</strong>.</p>
<h2 id="42-r-graphs-of-the-go-terms">4.2 R graphs of the GO terms</h2>
<p>Once we have all the .csv we proceed to make some graphs summarizing the results in r in this way:</p>
<h3 id="421-reading-the-data-of-a-csv-file-in-the-same-folder-as-the-script">4.2.1 reading the data of a csv file in the same folder as the script</h3>
<pre><code class="language-r"><div>DOWNDEG&lt;-read.csv(<span class="hljs-string">&quot;./salmonDeseqresults/SalmonDESeq2down.csv&quot;</span>)
</div></code></pre>
<h3 id="422-pie-grapgh-of-the-porcentage-of-each-go-term">4.2.2 Pie grapgh of the porcentage of each Go term</h3>
<h4 id="4221-for-the-down-regulated">4.2.2.1 for the down regulated:</h4>
<pre><code class="language-r"><div>BP&lt;-sum(DOWNDEG$Ontology==<span class="hljs-string">&quot;Biological Process&quot;</span>)/length(DOWNDEG$Ontology)
MF&lt;-sum(DOWNDEG$Ontology==<span class="hljs-string">&quot;Molecular Function&quot;</span>)/length(DOWNDEG$Ontology)
CC&lt;-sum(DOWNDEG$Ontology==<span class="hljs-string">&quot;Cellular Component&quot;</span>)/length(DOWNDEG$Ontology)

pie(c(BP,MF,CC),labels=c(paste(round(<span class="hljs-number">100</span>*BP,<span class="hljs-number">2</span>),<span class="hljs-string">&quot;%&quot;</span>),paste(round(<span class="hljs-number">100</span>*MF,<span class="hljs-number">1</span>),<span class="hljs-string">&quot;%&quot;</span>),paste(round(<span class="hljs-number">100</span>*CC,<span class="hljs-number">1</span>),<span class="hljs-string">&quot;%&quot;</span>)),explode=<span class="hljs-number">0.1</span>, main=<span class="hljs-string">&quot;&quot;</span>,col=c(<span class="hljs-string">&quot;blue&quot;</span>, <span class="hljs-string">&quot;lightblue&quot;</span>, <span class="hljs-string">&quot;cyan&quot;</span>))
legend(<span class="hljs-string">&quot;topright&quot;</span>, c(<span class="hljs-string">&quot;Biological Process&quot;</span>,<span class="hljs-string">&quot;Molecular Function&quot;</span>,<span class="hljs-string">&quot;Cellular Component&quot;</span>), cex = <span class="hljs-number">0.56</span>,fill = c(<span class="hljs-string">&quot;blue&quot;</span>, <span class="hljs-string">&quot;lightblue&quot;</span>, <span class="hljs-string">&quot;cyan&quot;</span>),box.lty=<span class="hljs-number">0</span>,inset = <span class="hljs-number">0.062</span>)

</div></code></pre>
<p align="center">
  <img width="460" height="300" src=PieDown.png>
  <p align="center"> Figure 13. Pie chart of down regulated genes in salmon by DESeq2<p>
</p>
<h4 id="4221-for-the-down-regulated-1">4.2.2.1 For the down regulated:</h4>
<pre><code class="language-r"><div>UPDEG&lt;-read.csv(<span class="hljs-string">&quot;./salmonDeseqresults/SalmonDESeq2up.csv&quot;</span>)
BP&lt;-sum(UPDEG$Ontology==<span class="hljs-string">&quot;Biological Process&quot;</span>)/length(UPDEG$Ontology)
MF&lt;-sum(UPDEG$Ontology==<span class="hljs-string">&quot;Molecular Function&quot;</span>)/length(UPDEG$Ontology)
CC&lt;-sum(UPDEG$Ontology==<span class="hljs-string">&quot;Cellular Component&quot;</span>)/length(UPDEG$Ontology)
pie(c(BP,MF,CC),labels=c(paste(round(<span class="hljs-number">100</span>*BP,<span class="hljs-number">1</span>),<span class="hljs-string">&quot;%&quot;</span>),paste(round(<span class="hljs-number">100</span>*MF,<span class="hljs-number">1</span>),<span class="hljs-string">&quot;%&quot;</span>),paste(round(<span class="hljs-number">100</span>*CC,<span class="hljs-number">1</span>),<span class="hljs-string">&quot;%&quot;</span>)),explode=<span class="hljs-number">0.1</span>, main=<span class="hljs-string">&quot;&quot;</span>,col=c(<span class="hljs-string">&quot;blue&quot;</span>, <span class="hljs-string">&quot;lightblue&quot;</span>, <span class="hljs-string">&quot;cyan&quot;</span>))
legend(<span class="hljs-string">&quot;topleft&quot;</span>, c(<span class="hljs-string">&quot;Biological Process&quot;</span>,<span class="hljs-string">&quot;Molecular Function&quot;</span>,<span class="hljs-string">&quot;Cellular Component&quot;</span>), cex = <span class="hljs-number">0.58</span>,fill = c(<span class="hljs-string">&quot;blue&quot;</span>, <span class="hljs-string">&quot;lightblue&quot;</span>, <span class="hljs-string">&quot;cyan&quot;</span>),box.lty=<span class="hljs-number">0</span>,inset =  <span class="hljs-number">0.04</span>)

</div></code></pre>
<p align="center">
  <img width="460" height="300" src=PieUp.png>
  <p align="center"> Figure 14. Pie chart of up regulated genes in salmon by DESeq2<p>
</p>
<h3 id="423-graph-of-principal-15-go-terms-being-down-and-up-regulated">4.2.3 Graph of principal 15 Go terms being down and up regulated:</h3>
<p>First the 15 most cited terms are filtered</p>
<h4 id="4231-for-down-regulated">4.2.3.1 For Down regulated:</h4>
<pre><code class="language-r"><div>terms&lt;-unique(DOWNDEG$GO.Term.Name)
counts&lt;-c(rep(<span class="hljs-number">0</span>,length(terms)))
<span class="hljs-keyword">for</span>( i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:length(terms)){
  <span class="hljs-keyword">for</span>(j <span class="hljs-keyword">in</span> DOWNDEG$GO.Term.Name){
    <span class="hljs-keyword">if</span>(terms[i]==j){
      counts[i]=counts[i]+<span class="hljs-number">1</span>
    }
  }
}
df&lt;-data.frame(counts,terms)
df1 &lt;- df[order(-counts),] 
df1&gt; df[with(df, order(-counts, terms)), ]
df2&lt;-df1[<span class="hljs-number">1</span>:<span class="hljs-number">15</span>,]
</div></code></pre>
<h4 id="4231-for-the-up-regulated">4.2.3.1 for the up regulated</h4>
<p>One counts the different processes and then the quantity:</p>
<pre><code class="language-r"><div>termsup&lt;-unique(UPDEG$GO.Term.Name)
countsup&lt;-c(rep(<span class="hljs-number">0</span>,length(termsup)))
<span class="hljs-keyword">for</span>( i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:length(termsup)){
  <span class="hljs-keyword">for</span>(j <span class="hljs-keyword">in</span> UPDEG$GO.Term.Name){
    <span class="hljs-keyword">if</span>(termsup[i]==j){
      countsup[i]=countsup[i]+<span class="hljs-number">1</span>
    }
  }
}
countsup
dfup&lt;-data.frame(countsup,termsup)
df1up &lt;- dfup[order(-countsup),] 
df1up&gt; dfup[with(df, order(-countsup, termsup)), ]
df2up&lt;-df1up[<span class="hljs-number">1</span>:<span class="hljs-number">15</span>,]
</div></code></pre>
<h3 id="424-unifying-the-data-frames-in-a-single-graph">4.2.4 Unifying the data frames in a single graph:</h3>
<pre><code class="language-r"><div>names(df2up)&lt;-names(df2)
df2up&lt;-na.omit(df2up)
df2&lt;-na.omit(df2)
df2all&lt;-rbind(df2, df2up)
</div></code></pre>
<h3 id="425-making-the-graph">4.2.5 making the graph:</h3>
<p><a href="#6.-footnotes">^10</a></p>
<pre><code class="language-r"><div><span class="hljs-keyword">library</span>(ggplot2)
<span class="hljs-keyword">library</span>(dplyr)
<span class="hljs-keyword">library</span>(forcats)
colors&lt;-c(rep(<span class="hljs-string">&quot;#f68060&quot;</span>,length(df2[,<span class="hljs-number">1</span>])),rep(<span class="hljs-string">&quot;#60d6f6&quot;</span>,length(df2up[,<span class="hljs-number">1</span>])))
rownames(df2all) &lt;- c()
df2all[<span class="hljs-string">&quot;Tgene&quot;</span>]&lt;-c(rep(<span class="hljs-number">1</span>,length(df2[,<span class="hljs-number">1</span>])),rep(<span class="hljs-number">2</span>,length(df2up[,<span class="hljs-number">1</span>])))
df2all[<span class="hljs-string">&quot;Type&quot;</span>]&lt;-c(rep(<span class="hljs-string">&quot;DOWN&quot;</span>,length(df2[,<span class="hljs-number">1</span>])),rep(<span class="hljs-string">&quot;UP&quot;</span>,length(df2up[,<span class="hljs-number">1</span>])))
df2all
df2all %&gt;%
  ggplot( aes(x=reorder(terms,Tgene), y=counts,fill=Type)) +
  geom_bar(stat=<span class="hljs-string">&quot;identity&quot;</span>, alpha=<span class="hljs-number">.8</span>, width=<span class="hljs-number">.5</span>) +
  coord_flip() +
  xlab(<span class="hljs-string">&quot;&quot;</span>) +
  theme_bw()+
  ylab(<span class="hljs-string">&quot;Number of genes&quot;</span>)+
  scale_fill_manual(values = c(<span class="hljs-string">&quot;#f68060&quot;</span>, <span class="hljs-string">&quot;#60d6f6&quot;</span>))
</div></code></pre>
<p align="center">
  <img width="460" height="300" src=Goanalysis.png>
  <p align="center"> Figure 15. Graph of the 15 most important GO terms<p>
</p>
<h2 id="43-set-analysis-of-dtg-using-the-fisher-test">4.3 set analysis of DTG using the Fisher test</h2>
<p>This analysis is usefull when there are a lot of DTG &gt;20, generally the ones from limma to make more biologically significant set of genes that represent a GO term.</p>
<h3 id="431-enrichment-analysis-using-the-fisher-test-in-tritryp">4.3.1 Enrichment analysis using the fisher test in TriTryp</h3>
<ul>
<li>
<p>One enters <a href="https://tritrypdb.org/tritrypdb/app/">https://tritrypdb.org/tritrypdb/app/</a> and the slecets my strategies since one already made some searches or follow <a href="#41-obtaining-the-archive-of-go-terms-and-the-fatsa-files-of-the-diferentially-transcripted-genesdte">4.1</a>. Being inthe results tab we click in <strong>Analize results</strong> an then select <strong>Gene ontology Enrichment</strong>.<br></p>
</li>
<li>
<p>after the page did the search we select <strong>cellular component</strong>, then we click in <strong>Download</strong>, after that we do the same but with  <strong>Molecular Function</strong> and <strong>Biological Process</strong> .<a href="#6.-footnotes">^6</a></p>
</li>
</ul>
<h3 id="432-reading-the-data-from-tritryp">4.3.2 reading the data from Tritryp</h3>
<pre><code class="language-r"><div><span class="hljs-keyword">library</span>(data.table)
CCDOWN&lt;-read.delim(<span class="hljs-string">&quot;./salmonlimmaresults/GoEnrichmentCCDOWNlimma.tab&quot;</span>,header = <span class="hljs-literal">T</span>, sep = <span class="hljs-string">&quot;\t&quot;</span>)
MFDOWN&lt;-read.delim(<span class="hljs-string">&quot;./salmonlimmaresults/GoEnrichmentMFDOWNlimma.tab&quot;</span>,header = <span class="hljs-literal">T</span>, sep = <span class="hljs-string">&quot;\t&quot;</span>)
MFUP&lt;-read.delim(<span class="hljs-string">&quot;./salmonlimmaresults/GoEnrichmentMFUPlimma.tab&quot;</span>,header = <span class="hljs-literal">T</span>, sep = <span class="hljs-string">&quot;\t&quot;</span>)
BPDOWN&lt;-read.delim(<span class="hljs-string">&quot;./salmonlimmaresults/GoEnrichmentBPDOWNlimma.tab&quot;</span>,header = <span class="hljs-literal">T</span>, sep = <span class="hljs-string">&quot;\t&quot;</span>)
BPUP&lt;-read.delim(<span class="hljs-string">&quot;./salmonlimmaresults/GoEnrichmentBPUPlimma.tab&quot;</span>,header = <span class="hljs-literal">T</span>, sep = <span class="hljs-string">&quot;\t&quot;</span>)
</div></code></pre>
<h3 id="432-creating-tables-with-the-lower-p-value">4.3.2 Creating tables with the lower P-value</h3>
<pre><code class="language-r"><div><span class="hljs-keyword">library</span>(gridExtra)
df&lt;-data.frame(CCDOWN$Name[<span class="hljs-number">1</span>:<span class="hljs-number">10</span>],MFDOWN$Name[<span class="hljs-number">1</span>:<span class="hljs-number">10</span>],MFUP$Name[<span class="hljs-number">1</span>:<span class="hljs-number">10</span>],BPDOWN$Name[<span class="hljs-number">1</span>:<span class="hljs-number">10</span>],BPUP$Name[<span class="hljs-number">1</span>:<span class="hljs-number">10</span>])
df1&lt;-data.frame(CCDOWN$Name[<span class="hljs-number">1</span>:<span class="hljs-number">10</span>],MFDOWN$Name[<span class="hljs-number">1</span>:<span class="hljs-number">10</span>])
names(df1)&lt;-c(<span class="hljs-string">&#x27;CCUP&#x27;</span>,<span class="hljs-string">&#x27;MFUP&#x27;</span>)
grid.table(df1)
df2&lt;-data.frame(BPDOWN$Name[<span class="hljs-number">1</span>:<span class="hljs-number">10</span>])
names(df2)&lt;-c(<span class="hljs-string">&#x27;BPUP&#x27;</span>)
grid.table(df2)
df3&lt;-data.frame(MFUP$Name[<span class="hljs-number">1</span>:<span class="hljs-number">10</span>],BPUP$Name[<span class="hljs-number">1</span>:<span class="hljs-number">10</span>])
names(df3)&lt;-c(<span class="hljs-string">&#x27;MFDOWN&#x27;</span>,<span class="hljs-string">&#x27;BPDOWN&#x27;</span>)
grid.table(df3)
</div></code></pre>
<p align="center">
  <img width="460" height="300" src=enrichment.png>
  <p align="center"> Figure 16. Enriched genes table<p>
</p>
<h2 id="44-pathway-analysis-using-keeg-kaas">4.4 Pathway analysis using KEEG-KAAS</h2>
<p>Enter the following page <a href="https://www.genome.jp/kegg/kaas/">https://www.genome.jp/kegg/kaas/</a> and then select the <strong>Partial Genome</strong>. Select also <strong>GHOSTX</strong> ans down check <strong>File Upload</strong> Enter the fasta files downloaded in <a href="#412-pathway-analysis">4.1.2</a>. Afterwards one must give a unique name to the query and enter a valid mail to verify later. For the organisms, one should erase all and for <em>T.cruzi</em>  one should click <strong>Organism List</strong> and then select kinetoplastids in the pop-up. Finally click in <strong>Compute</strong>  and wait until you get the mail notification. When the first notification comes, one should click it to activate the compute, and a compute can only be done one at a time.</p>
<h3 id="441-analysis-of-the-keeg-results">4.4.1 Analysis of the KEEG results</h3>
<p>What one should analyze are first routes. One should also analyze after selecting <strong>Execute</strong>, the brite and module should also be analyzed.</p>
<h1 id="5-optionals">5. Optionals:</h1>
<h2 id="51-counting-with-ht-seq">5.1 Counting with HT-seq</h2>
<p>HT-seq is a tool for counting mapped reads to genes in bam files with respect to a reference genome, where the package should be downloaded. The first command is for single reads the second is for paired reads (HT-seq doesn't work with alignments that quantify single and paired reads at the same time so one shoud separate these):</p>
<pre><code class="language-bash"><div>conda create -n htseq HTSeq

htseq-count -s no -f bam -n 4 ./ERR3501950/accepted_hits.bam.SE.bam TriTrypDB-46_TcruziSylvioX10-1.gtf &gt; SE_50_count.txt

htseq-count -s no -r name -f bam -n 4 ./ERR3501950/accepted_hits.bam.PE.bam TriTrypDB-46_TcruziSylvioX10-1.gtf &gt; PE_50_counts.txt
</div></code></pre>
<ul>
<li>To sepate a bam archive in a bam of single reads and a bam of paired reads do:</li>
</ul>
<pre><code class="language-bash"><div>conda activate samtools
samtools view -bf 1 foo.bam &gt; foo.paired-end.bam
samtools view -bF 1 foo.bam &gt; foo.single-end.bam
</div></code></pre>
<h2 id="52-generating-a-gtf-from-a-gff">5.2 Generating a gtf from a gff</h2>
<pre><code class="language-bash"><div>conda create -n agat -c bioconda agat

agat_convert_sp_gff2gtf.pl --gff TriTrypDB-46_TcruziSylvioX10-1.gff -o 1_TriTrypDB-46_TcruziSylvioX10-1.gtf
</div></code></pre>
<h2 id="53-changing-the-formats-of-some-reads-with-biopython">5.3 Changing the formats of some reads with BioPython</h2>
<p>one installs biopython and then:</p>
<pre><code class="language-python"><div><span class="hljs-keyword">from</span> Bio <span class="hljs-keyword">import</span> SeqIO
count = SeqIO.convert(<span class="hljs-string">&quot;G5ABAL401.RCl3.sff&quot;</span>, <span class="hljs-string">&quot;sff&quot;</span>, <span class="hljs-string">&quot;RCl3.fastq&quot;</span>, <span class="hljs-string">&quot;fastq&quot;</span>)
</div></code></pre>
<h2 id="54-to-change-permisiion-in-files">5.4 to change permisiion in files</h2>
<p>To make everything available inside a folder use:</p>
<pre><code class="language-bash"><div>sudo chmod -R a+rwX file/
</div></code></pre>
<h2 id="55-transcriptome-de-novo-reconstruction">5.5 Transcriptome de novo reconstruction</h2>
<ul>
<li><a href="https://www.rna.uni-jena.de/compared-the-best-de-novo-transcriptome-assembly-tools/">https://www.rna.uni-jena.de/compared-the-best-de-novo-transcriptome-assembly-tools/</a></li>
</ul>
<p>Spades is very good for assembly so i would use that option</p>
<h1 id="6-footnotes">6. Footnotes</h1>
<p>[^1] : In some cases the we do a De novo transcriptome ensemble in which there are other steps.<br>
[^2] : To obtain the transcriptome and the  gtf from <em>T. cruzi</em> we select in data, then Download data, current release yand search frothe species we're going to analyze in <a href="https://tritrypdb.org/tritrypdb/app">https://tritrypdb.org/tritrypdb/app</a> <br>
[^3] for more information about this see: <a href="https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#count-matrix-input">https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#count-matrix-input</a> <br>
[^4] for more information about this see : <a href="https://www.biostars.org/p/293212/">https://www.biostars.org/p/293212/</a> <br>
[^5] A visual tutorial about this is avalilable in: <a href="https://www.youtube.com/watch?v=npgkkychkrI&amp;list=LLUISwaoqeJZF8tvTzj2aX9w&amp;index=1">https://www.youtube.com/watch?v=npgkkychkrI&amp;list=LLUISwaoqeJZF8tvTzj2aX9w&amp;index=1</a> <br>
[^6] A visual tutorial about this is avalilable in: <a href="https://www.youtube.com/watch?v=qGLkAEzQpqU&amp;list=LLUISwaoqeJZF8tvTzj2aX9w&amp;index=3&amp;t=0s">https://www.youtube.com/watch?v=qGLkAEzQpqU&amp;list=LLUISwaoqeJZF8tvTzj2aX9w&amp;index=3&amp;t=0s</a><br>
[^7]for more information about this discussion see: <a href="https://support.bioconductor.org/p/81094/">https://support.bioconductor.org/p/81094/</a><br>
[^8] For a compressed guide of DESeq2 there is: <a href="https://bioconductor.github.io/BiocWorkshops/rna-seq-data-analysis-with-deseq2.html">https://bioconductor.github.io/BiocWorkshops/rna-seq-data-analysis-with-deseq2.html</a><br>
[^9] Trapnell, C., Roberts, A., Goff, L., Pertea, G., Kim, D., Kelley, D. R., ... &amp; Pachter, L. (2012). Differential gene and transcript expression analysis of RNA-seq experiments with TopHat and Cufflinks. Nature protocols, 7(3), 562-578.
[^10]for colors <a href="https://www.colorhexa.com/f68060">https://www.colorhexa.com/f68060</a></p>
<h1 id="7-references">7. References</h1>
<p>[1] Williams, C. R., Baccarella, A., Parrish, J. Z., &amp; Kim, C. C. (2017). Empirical assessment of analysis workflows for differential expression analysis of human samples using RNA-Seq. BMC bioinformatics, 18(1), 38.<br>
[2] Zhu, A., Ibrahim, J. G., &amp; Love, M. I. (2019). Heavy-tailed prior distributions for sequence count data: removing the noise and preserving large differences. Bioinformatics, 35(12), 2084-2092.<br>
[3]<a href="https://cgatoxford.wordpress.com/2016/08/17/why-you-should-stop-using-featurecounts-htseq-or-cufflinks2-and-start-using-kallisto-salmon-or-sailfish/">https://cgatoxford.wordpress.com/2016/08/17/why-you-should-stop-using-featurecounts-htseq-or-cufflinks2-and-start-using-kallisto-salmon-or-sailfish/</a><br>
[4] Yi, L., Liu, L., Melsted, P., &amp; Pachter, L. (2018). A direct comparison of genome alignment and transcriptome pseudoalignment. BioRxiv, 444620.<br>
-Anders, S., Pyl, P. T., &amp; Huber, W. (2015). HTSeq—a Python framework to work with high-throughput sequencing data. Bioinformatics, 31(2), 166-169.<br>
-Andrews S. (2010). FastQC: a quality control tool for high throughput sequence data.<br>
-Aslett, M., Aurrecoechea, C., Berriman, M., Brestelli, J., Brunk, B. P., Carrington, M., ... &amp; Gardner, M. J. (2010). TriTrypDB: a functional genomic resource for the Trypanosomatidae. Nucleic acids research, 38(suppl_1), D457-D462.<br>
-Bolger, A. M., Lohse, M., &amp; Usadel, B. (2014). Trimmomatic: a flexible trimmer for Illumina sequence data. Bioinformatics, 30(15), 2114-2120.<br>
Brian Bushnel. (2016). HISAT2 or Tophat2. Retrieved from <a href="https://www.biostars.org/p/230724/">https://www.biostars.org/p/230724/</a><br>
-Cock, P. J., Antao, T., Chang, J. T., Chapman, B. A., Cox, C. J., Dalke, A., ... &amp; De Hoon, M. J. (2009). Biopython: freely available Python tools for computational molecular biology and bioinformatics. Bioinformatics, 25(11), 1422-1423.<br>
-Cock, P. J., Fields, C. J., Goto, N., Heuer, M. L., &amp; Rice, P. M. (2010). The Sanger FASTQ file format for sequences with quality scores, and the Solexa/Illumina FASTQ variants. Nucleic acids research, 38(6), 1767-1771.<br>
-Cruz-Saavedra, L., Muñoz, M., Patiño, L. H., Vallejo, G. A., Guhl, F., &amp; Ramírez, J. D. (2020). Slight temperature changes cause rapid transcriptomic responses in Trypanosoma cruzi metacyclic trypomastigotes. Parasites &amp; vectors, 13, 1-16.<br>
-Garber, M., Grabherr, M. G., Guttman, M., &amp; Trapnell, C. (2011). Computational methods for transcriptome annotation and quantification using RNA-seq. Nature methods, 8(6), 469-477.<br>
-Kim, D., Langmead, B., &amp; Salzberg, S. L. (2015). HISAT: a fast spliced aligner with low memory requirements. Nature methods, 12(4), 357-360.<br>
-Law, C. W., Chen, Y., Shi, W., &amp; Smyth, G. K. (2014). voom: Precision weights unlock linear model analysis tools for RNA-seq read counts. Genome biology, 15(2), R29.<br>
-Liao, Y., Smyth, G. K., &amp; Shi, W. (2014). featureCounts: an efficient general purpose program for assigning sequence reads to genomic features. Bioinformatics, 30(7), 923-930.<br>
-Love, M. I., Huber, W., &amp; Anders, S. (2014). Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2. Genome biology, 15(12), 550.<br>
-Ma’ayan Avii (2014). The Fisher Exact test, Network Analysis in Systems Biology . Coursera BC : Mount Sinai Center for Bioinformatics. <br>
-Moriya, Y., Itoh, M., Okuda, S., Yoshizawa, A. C., &amp; Kanehisa, M. (2007). KAAS: an automatic genome annotation and pathway reconstruction server. Nucleic acids research, 35(suppl_2), W182-W185.<br>
-Patro, R., Duggal, G., Love, M. I., Irizarry, R. A., &amp; Kingsford, C. (2017). Salmon provides fast and bias-aware quantification of transcript expression. Nature methods, 14(4), 417-419.<br>
-Team, R. C. (2013). R: A language and environment for statistical computing.<br>
-Trapnell, C., Hendrickson, D. G., Sauvageau, M., Goff, L., Rinn, J. L., &amp; Pachter, L. (2013). Differential analysis of gene regulation at transcript resolution with RNA-seq. Nature biotechnology, 31(1), 46-53.</p>

    </body>
    </html>